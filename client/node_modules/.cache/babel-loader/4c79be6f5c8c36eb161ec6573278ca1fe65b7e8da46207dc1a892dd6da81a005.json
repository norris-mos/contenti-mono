{"ast":null,"code":"import * as React from 'react';\nimport { Component, createRef } from 'react';\nimport { defineElements } from '@lumieducation/h5p-webcomponents';\ndefineElements('h5p-editor');\nexport default class H5PEditorUI extends Component {\n  constructor(props) {\n    super(props);\n    this.loadContentCallbackWrapper = contentId => {\n      return this.props.loadContentCallback(contentId);\n    };\n    this.onEditorLoaded = event => {\n      if (this.props.onLoaded) {\n        this.props.onLoaded(event.detail.contentId, event.detail.ubername);\n      }\n    };\n    this.onSaved = event => {\n      if (this.props.onSaved) {\n        this.props.onSaved(event.detail.contentId, event.detail.metadata);\n      }\n    };\n    this.onSaveError = async event => {\n      if (this.props.onSaveError) {\n        this.props.onSaveError(event.detail.message);\n      }\n    };\n    this.saveContentCallbackWrapper = (contentId, requestBody) => {\n      return this.props.saveContentCallback(contentId, requestBody);\n    };\n    this.h5pEditor = createRef();\n  }\n  componentDidMount() {\n    this.registerEvents();\n    this.setServiceCallbacks();\n  }\n  componentDidUpdate() {\n    var _a;\n    this.registerEvents();\n    this.setServiceCallbacks();\n    (_a = this.h5pEditor.current) === null || _a === void 0 ? void 0 : _a.resize();\n  }\n  componentWillUnmount() {\n    this.unregisterEvents();\n  }\n  getSnapshotBeforeUpdate() {\n    // Should the old editor instance be destroyed, we unregister from it...\n    this.unregisterEvents();\n    return null;\n  }\n  render() {\n    return React.createElement(\"h5p-editor\", {\n      ref: this.h5pEditor,\n      \"content-id\": this.props.contentId\n    });\n  }\n  /**\n   * Call this method to save the current state of the h5p editor. This will\n   * result in a call to the `saveContentCallback` that was passed in the\n   * through the props.\n   * @throws an error if there was a problem (e.g. validation error of the\n   * content)\n   */\n  async save() {\n    var _a;\n    try {\n      return await ((_a = this.h5pEditor.current) === null || _a === void 0 ? void 0 : _a.save());\n    } catch (error) {\n      // We ignore the error, as we subscribe to the 'save-error' and\n      // 'validation-error' events.\n    }\n  }\n  registerEvents() {\n    var _a, _b, _c, _d;\n    (_a = this.h5pEditor.current) === null || _a === void 0 ? void 0 : _a.addEventListener('saved', this.onSaved);\n    (_b = this.h5pEditor.current) === null || _b === void 0 ? void 0 : _b.addEventListener('editorloaded', this.onEditorLoaded);\n    (_c = this.h5pEditor.current) === null || _c === void 0 ? void 0 : _c.addEventListener('save-error', this.onSaveError);\n    (_d = this.h5pEditor.current) === null || _d === void 0 ? void 0 : _d.addEventListener('validation-error', this.onSaveError);\n  }\n  setServiceCallbacks() {\n    if (this.h5pEditor.current) {\n      this.h5pEditor.current.loadContentCallback = this.loadContentCallbackWrapper;\n      this.h5pEditor.current.saveContentCallback = this.saveContentCallbackWrapper;\n    }\n  }\n  unregisterEvents() {\n    var _a, _b, _c, _d;\n    (_a = this.h5pEditor.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('saved', this.onSaved);\n    (_b = this.h5pEditor.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('editorloaded', this.onEditorLoaded);\n    (_c = this.h5pEditor.current) === null || _c === void 0 ? void 0 : _c.removeEventListener('save-error', this.onSaveError);\n    (_d = this.h5pEditor.current) === null || _d === void 0 ? void 0 : _d.removeEventListener('validation-error', this.onSaveError);\n  }\n}","map":{"version":3,"names":["React","Component","createRef","defineElements","H5PEditorUI","constructor","props","loadContentCallbackWrapper","contentId","loadContentCallback","onEditorLoaded","event","onLoaded","detail","ubername","onSaved","metadata","onSaveError","message","saveContentCallbackWrapper","requestBody","saveContentCallback","h5pEditor","componentDidMount","registerEvents","setServiceCallbacks","componentDidUpdate","_a","current","resize","componentWillUnmount","unregisterEvents","getSnapshotBeforeUpdate","render","createElement","ref","save","error","addEventListener","_b","_c","_d","removeEventListener"],"sources":["/Users/maxoliverstapyltonnorris/contenti-mono/h5p-rest-example-client/node_modules/@lumieducation/h5p-react/src/H5PEditorUI.tsx"],"sourcesContent":["import * as React from 'react';\nimport { Component, createRef, ReactNode, RefObject } from 'react';\n\nimport {\n    defineElements,\n    H5PEditorComponent as H5PEditorWebComponent\n} from '@lumieducation/h5p-webcomponents';\nimport type { IContentMetadata, IEditorModel } from '@lumieducation/h5p-server';\n\ndefineElements('h5p-editor');\n\ndeclare global {\n    /**\n     * Enables type checks for JSX.\n     */\n    namespace JSX {\n        interface IntrinsicElements {\n            'h5p-editor': {\n                'content-id'?: string;\n                'h5p-url'?: string;\n                ref?: any;\n            };\n        }\n    }\n}\n\ninterface IH5PEditorUIProps {\n    contentId: string;\n    loadContentCallback: (contentId: string) => Promise<\n        IEditorModel & {\n            library?: string;\n            metadata?: IContentMetadata;\n            params?: any;\n        }\n    >;\n    onLoaded?: (contentId: string, ubername: string) => void;\n    onSaved?: (contentId: string, metadata: IContentMetadata) => void;\n    onSaveError?: (errorMessage: string) => void;\n    saveContentCallback: (\n        contentId: string,\n        requestBody: {\n            library: string;\n            params: any;\n        }\n    ) => Promise<{\n        contentId: string;\n        metadata: IContentMetadata;\n    }>;\n}\n\nexport default class H5PEditorUI extends Component<IH5PEditorUIProps> {\n    constructor(props: IH5PEditorUIProps) {\n        super(props);\n        this.h5pEditor = createRef();\n    }\n\n    private h5pEditor: RefObject<H5PEditorWebComponent>;\n\n    public componentDidMount(): void {\n        this.registerEvents();\n        this.setServiceCallbacks();\n    }\n\n    public componentDidUpdate(): void {\n        this.registerEvents();\n        this.setServiceCallbacks();\n        this.h5pEditor.current?.resize();\n    }\n\n    public componentWillUnmount(): void {\n        this.unregisterEvents();\n    }\n\n    public getSnapshotBeforeUpdate(): void {\n        // Should the old editor instance be destroyed, we unregister from it...\n        this.unregisterEvents();\n        return null;\n    }\n\n    public render(): ReactNode {\n        return (\n            <h5p-editor\n                ref={this.h5pEditor}\n                content-id={this.props.contentId}\n            ></h5p-editor>\n        );\n    }\n\n    /**\n     * Call this method to save the current state of the h5p editor. This will\n     * result in a call to the `saveContentCallback` that was passed in the\n     * through the props.\n     * @throws an error if there was a problem (e.g. validation error of the\n     * content)\n     */\n    public async save(): Promise<\n        | {\n              contentId: string;\n              metadata: IContentMetadata;\n          }\n        | undefined\n    > {\n        try {\n            return await this.h5pEditor.current?.save();\n        } catch (error) {\n            // We ignore the error, as we subscribe to the 'save-error' and\n            // 'validation-error' events.\n        }\n    }\n\n    private loadContentCallbackWrapper = (\n        contentId: string\n    ): Promise<\n        IEditorModel & {\n            library?: string;\n            metadata?: IContentMetadata;\n            params?: any;\n        }\n    > => {\n        return this.props.loadContentCallback(contentId);\n    };\n\n    private onEditorLoaded = (\n        event: CustomEvent<{ contentId: string; ubername: string }>\n    ): void => {\n        if (this.props.onLoaded) {\n            this.props.onLoaded(event.detail.contentId, event.detail.ubername);\n        }\n    };\n\n    private onSaved = (\n        event: CustomEvent<{ contentId: string; metadata: IContentMetadata }>\n    ): void => {\n        if (this.props.onSaved) {\n            this.props.onSaved(event.detail.contentId, event.detail.metadata);\n        }\n    };\n\n    private onSaveError = async (\n        event: CustomEvent<{ message: string }>\n    ): Promise<void> => {\n        if (this.props.onSaveError) {\n            this.props.onSaveError(event.detail.message);\n        }\n    };\n\n    private registerEvents(): void {\n        this.h5pEditor.current?.addEventListener('saved', this.onSaved);\n        this.h5pEditor.current?.addEventListener(\n            'editorloaded',\n            this.onEditorLoaded\n        );\n        this.h5pEditor.current?.addEventListener(\n            'save-error',\n            this.onSaveError\n        );\n        this.h5pEditor.current?.addEventListener(\n            'validation-error',\n            this.onSaveError\n        );\n    }\n\n    private saveContentCallbackWrapper = (\n        contentId: string,\n        requestBody: {\n            library: string;\n            params: any;\n        }\n    ): Promise<{\n        contentId: string;\n        metadata: IContentMetadata;\n    }> => {\n        return this.props.saveContentCallback(contentId, requestBody);\n    };\n\n    private setServiceCallbacks(): void {\n        if (this.h5pEditor.current) {\n            this.h5pEditor.current.loadContentCallback =\n                this.loadContentCallbackWrapper;\n            this.h5pEditor.current.saveContentCallback =\n                this.saveContentCallbackWrapper;\n        }\n    }\n\n    private unregisterEvents(): void {\n        this.h5pEditor.current?.removeEventListener('saved', this.onSaved);\n        this.h5pEditor.current?.removeEventListener(\n            'editorloaded',\n            this.onEditorLoaded\n        );\n        this.h5pEditor.current?.removeEventListener(\n            'save-error',\n            this.onSaveError\n        );\n        this.h5pEditor.current?.removeEventListener(\n            'validation-error',\n            this.onSaveError\n        );\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}