{"ast":null,"code":"import _regeneratorRuntime from\"/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import Alert from'react-bootstrap/Alert';import{Button,Col,Dropdown,Row}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=/*#__PURE__*/function(_React$Component){_inherits(Login,_React$Component);var _super=_createSuper(Login);function Login(props){var _this;_classCallCheck(this,Login);_this=_super.call(this,props);_this.login=function(username){fetch('/login',{method:'POST',headers:{Accept:'application/json, text/plain, */*','Content-type':'application/json'},body:JSON.stringify({username:username,password:username})}).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(res){var loginData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(res.status===200)){_context.next=8;break;}_context.next=3;return res.json();case 3:loginData=_context.sent;_this.setState(_objectSpread(_objectSpread({},_this.state),{},{loginData:loginData,loginMessage:undefined}));if(loginData.csrfToken){_this.props.contentService.setCsrfToken(loginData.csrfToken);}_context.next=20;break;case 8:_context.t0=_this;_context.t1=_objectSpread;_context.t2=_objectSpread({},_this.state);_context.t3={};_context.t4=undefined;_context.next=15;return res.text();case 15:_context.t5=_context.sent;_context.t6={loginData:_context.t4,loginMessage:_context.t5};_context.t7=(0,_context.t1)(_context.t2,_context.t3,_context.t6);_context.t0.setState.call(_context.t0,_context.t7);_this.props.contentService.setCsrfToken(undefined);case 20:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(reason){_this.setState(_objectSpread(_objectSpread({},_this.state),{},{loginData:undefined,loginMessage:reason}));_this.props.contentService.setCsrfToken(undefined);});};_this.logout=function(){var _this$props$contentSe;fetch('/logout',{method:'POST',headers:{Accept:'application/json, text/plain, */*','Content-type':'application/json','CSRF-Token':(_this$props$contentSe=_this.props.contentService.getCsrfToken())!==null&&_this$props$contentSe!==void 0?_this$props$contentSe:''},body:JSON.stringify({})}).then(function(){_this.setState(_objectSpread(_objectSpread({},_this.state),{},{loginData:undefined,loginMessage:undefined}));_this.props.contentService.setCsrfToken(undefined);}).catch(function(reason){_this.setState(_objectSpread(_objectSpread({},_this.state),{},{loginData:undefined,loginMessage:\"Error logging out: \".concat(reason)}));_this.props.contentService.setCsrfToken(undefined);});};_this.state={};return _this;}_createClass(Login,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(React.Fragment,{children:[!this.state.loginData?/*#__PURE__*/_jsxs(Dropdown,{children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{variant:\"success\",id:\"dropdown-basic\",children:\"Login as\"}),/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return _this2.login('teacher1');},children:\"Teacher 1\"}),/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return _this2.login('teacher2');},children:\"Teacher 2\"}),/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return _this2.login('student1');},children:\"Student 1\"}),/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return _this2.login('student2');},children:\"Student 2\"})]})]}):/*#__PURE__*/_jsxs(Row,{className:\"align-items-center\",children:[/*#__PURE__*/_jsx(Col,{children:this.state.loginData.name}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Button,{onClick:this.logout,children:\"Logout\"})})]}),this.state.loginMessage&&/*#__PURE__*/_jsx(Alert,{variant:\"error\",children:this.state.loginMessage})]});}}]);return Login;}(React.Component);export{Login as default};","map":{"version":3,"names":["React","Alert","Button","Col","Dropdown","Row","jsx","_jsx","jsxs","_jsxs","Login","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","login","username","fetch","method","headers","Accept","body","JSON","stringify","password","then","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","loginData","wrap","_callee$","_context","prev","next","status","json","sent","setState","_objectSpread","state","loginMessage","undefined","csrfToken","contentService","setCsrfToken","t0","t1","t2","t3","t4","text","t5","t6","t7","stop","_x","apply","arguments","catch","reason","logout","_this$props$contentSe","getCsrfToken","concat","_createClass","key","value","render","_this2","Fragment","children","Toggle","variant","id","Menu","Item","onClick","className","name","Component","default"],"sources":["/Users/maxoliverstapyltonnorris/H5P-Nodejs-library/packages/h5p-rest-example-client/src/components/Login.tsx"],"sourcesContent":["import React from 'react';\nimport Alert from 'react-bootstrap/Alert';\nimport { Button, Col, Dropdown, Row } from 'react-bootstrap';\n\nimport { ContentService } from '../services/ContentService';\n\nexport default class Login extends React.Component<\n    { contentService: ContentService },\n    {\n        loginData?: {\n            username: string;\n            name: string;\n            email: string;\n            csrfToken: string;\n        };\n        loginMessage?: string;\n    }\n> {\n    constructor(props) {\n        super(props);\n        this.state = {};\n    }\n\n    private login = (username) => {\n        fetch('/login', {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json, text/plain, */*',\n                'Content-type': 'application/json'\n            },\n            body: JSON.stringify({\n                username: username,\n                password: username\n            })\n        })\n            .then(async (res) => {\n                if (res.status === 200) {\n                    const loginData = await res.json();\n                    this.setState({\n                        ...this.state,\n                        loginData,\n                        loginMessage: undefined\n                    });\n                    if (loginData.csrfToken) {\n                        this.props.contentService.setCsrfToken(\n                            loginData.csrfToken\n                        );\n                    }\n                } else {\n                    this.setState({\n                        ...this.state,\n                        loginData: undefined,\n                        loginMessage: await res.text()\n                    });\n                    this.props.contentService.setCsrfToken(undefined);\n                }\n            })\n            .catch((reason) => {\n                this.setState({\n                    ...this.state,\n                    loginData: undefined,\n                    loginMessage: reason\n                });\n                this.props.contentService.setCsrfToken(undefined);\n            });\n    };\n\n    logout = () => {\n        fetch('/logout', {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json, text/plain, */*',\n                'Content-type': 'application/json',\n                'CSRF-Token': this.props.contentService.getCsrfToken() ?? ''\n            },\n            body: JSON.stringify({})\n        })\n            .then(() => {\n                this.setState({\n                    ...this.state,\n                    loginData: undefined,\n                    loginMessage: undefined\n                });\n                this.props.contentService.setCsrfToken(undefined);\n            })\n            .catch((reason) => {\n                this.setState({\n                    ...this.state,\n                    loginData: undefined,\n                    loginMessage: `Error logging out: ${reason}`\n                });\n                this.props.contentService.setCsrfToken(undefined);\n            });\n    };\n\n    render() {\n        return (\n            <React.Fragment>\n                {!this.state.loginData ? (\n                    <Dropdown>\n                        <Dropdown.Toggle variant=\"success\" id=\"dropdown-basic\">\n                            Login as\n                        </Dropdown.Toggle>\n                        <Dropdown.Menu>\n                            <Dropdown.Item\n                                onClick={() => this.login('teacher1')}\n                            >\n                                Teacher 1\n                            </Dropdown.Item>\n                            <Dropdown.Item\n                                onClick={() => this.login('teacher2')}\n                            >\n                                Teacher 2\n                            </Dropdown.Item>\n                            <Dropdown.Item\n                                onClick={() => this.login('student1')}\n                            >\n                                Student 1\n                            </Dropdown.Item>\n                            <Dropdown.Item\n                                onClick={() => this.login('student2')}\n                            >\n                                Student 2\n                            </Dropdown.Item>\n                        </Dropdown.Menu>\n                    </Dropdown>\n                ) : (\n                    <Row className=\"align-items-center\">\n                        <Col>{this.state.loginData.name}</Col>\n                        <Col>\n                            <Button onClick={this.logout}>Logout</Button>\n                        </Col>\n                    </Row>\n                )}\n                {this.state.loginMessage && (\n                    <Alert variant=\"error\">{this.state.loginMessage}</Alert>\n                )}\n            </React.Fragment>\n        );\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}