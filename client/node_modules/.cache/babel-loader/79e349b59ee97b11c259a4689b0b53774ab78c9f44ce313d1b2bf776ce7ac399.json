{"ast":null,"code":"import * as React from 'react';\nimport { Component, createRef } from 'react';\nimport { defineElements } from '@lumieducation/h5p-webcomponents';\ndefineElements('h5p-player');\nexport default class H5PPlayerUI extends Component {\n  constructor(props) {\n    super(props);\n    this.loadContentCallbackWrapper = contentId => this.props.loadContentCallback(contentId);\n    this.onInitialized = event => {\n      if (this.props.onInitialized) {\n        this.props.onInitialized(event.detail.contentId);\n      }\n    };\n    this.onxAPIStatement = event => {\n      if (this.props.onxAPIStatement) {\n        this.props.onxAPIStatement(event.detail.statement, event.detail.context, event.detail.event);\n      }\n    };\n    this.h5pPlayer = createRef();\n  }\n  componentDidMount() {\n    this.registerEvents();\n    this.setServiceCallbacks();\n  }\n  componentDidUpdate() {\n    this.registerEvents();\n    this.setServiceCallbacks();\n  }\n  componentWillUnmount() {\n    this.unregisterEvents();\n  }\n  /**\n   * The internal H5P instance object of the H5P content.\n   *\n   * Only available after the `initialized` event was fired. Important: This\n   * object is only partially typed and there are more properties and methods\n   * on it!\n   */\n  get h5pInstance() {\n    var _a;\n    return (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.h5pInstance;\n  }\n  /**\n   * The global H5P object / namespace (normally accessible through \"H5P...\"\n   * or \"window.H5P\") of the content type. Depending on the embed type this\n   * can be an object from the internal iframe, so you can use it to break the\n   * barrier of the iframe and execute JavaScript inside the iframe.\n   *\n   * Only available after the `initialized` event was fired. Important: This\n   * object is only partially typed and there are more properties and methods\n   * on it!\n   */\n  get h5pObject() {\n    var _a;\n    return (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.h5pObject;\n  }\n  /**\n   * Returns the copyright notice in HTML that you can insert somewhere to\n   * display it. Undefined if there is no copyright information.\n   */\n  getCopyrightHtml() {\n    var _a, _b;\n    return (_b = (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.getCopyrightHtml()) !== null && _b !== void 0 ? _b : '';\n  }\n  getSnapshotBeforeUpdate() {\n    // Should the old editor instance be destroyed, we unregister from it...\n    this.unregisterEvents();\n    return null;\n  }\n  /**\n   * @returns true if there is copyright information to be displayed.\n   */\n  hasCopyrightInformation() {\n    var _a;\n    return (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.hasCopyrightInformation();\n  }\n  render() {\n    return React.createElement(\"h5p-player\", {\n      ref: this.h5pPlayer,\n      \"content-id\": this.props.contentId\n    });\n  }\n  /**\n   * Displays the copyright notice in the regular H5P way.\n   */\n  showCopyright() {\n    var _a;\n    (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.showCopyright();\n  }\n  /**\n   * Asks the H5P content to resize itself inside the dimensions of the\n   * container.\n   *\n   * Has no effect until the H5P object has fully initialized.\n   */\n  resize() {\n    var _a;\n    (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.resize();\n  }\n  registerEvents() {\n    var _a, _b;\n    (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.addEventListener('initialized', this.onInitialized);\n    if (this.props.onxAPIStatement) {\n      (_b = this.h5pPlayer.current) === null || _b === void 0 ? void 0 : _b.addEventListener('xAPI', this.onxAPIStatement);\n    }\n  }\n  setServiceCallbacks() {\n    if (this.h5pPlayer.current) {\n      this.h5pPlayer.current.loadContentCallback = this.loadContentCallbackWrapper;\n    }\n  }\n  unregisterEvents() {\n    var _a, _b;\n    (_a = this.h5pPlayer.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('initialized', this.onInitialized);\n    if (this.props.onxAPIStatement) {\n      (_b = this.h5pPlayer.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('xAPI', this.onxAPIStatement);\n    }\n  }\n}","map":{"version":3,"names":["React","Component","createRef","defineElements","H5PPlayerUI","constructor","props","loadContentCallbackWrapper","contentId","loadContentCallback","onInitialized","event","detail","onxAPIStatement","statement","context","h5pPlayer","componentDidMount","registerEvents","setServiceCallbacks","componentDidUpdate","componentWillUnmount","unregisterEvents","h5pInstance","_a","current","h5pObject","getCopyrightHtml","_b","getSnapshotBeforeUpdate","hasCopyrightInformation","render","createElement","ref","showCopyright","resize","addEventListener","removeEventListener"],"sources":["/Users/maxoliverstapyltonnorris/contenti-mono/client/node_modules/@lumieducation/h5p-react/src/H5PPlayerUI.tsx"],"sourcesContent":["import * as React from 'react';\nimport { Component, createRef, ReactNode, RefObject } from 'react';\n\nimport {\n    defineElements,\n    H5PPlayerComponent,\n    IxAPIEvent,\n    IContext,\n    IH5PInstance,\n    IH5P\n} from '@lumieducation/h5p-webcomponents';\nimport type { IPlayerModel } from '@lumieducation/h5p-server';\n\ndefineElements('h5p-player');\n\ndeclare global {\n    namespace JSX {\n        interface IntrinsicElements {\n            'h5p-player': {\n                'content-id'?: string;\n                ref?: any;\n            };\n        }\n    }\n}\n\ninterface IH5PPlayerUIProps {\n    contentId: string;\n    loadContentCallback: (contentId: string) => Promise<IPlayerModel>;\n    onInitialized?: (contentId: string) => void;\n    onxAPIStatement?: (statement: any, context: any, event: IxAPIEvent) => void;\n}\n\nexport default class H5PPlayerUI extends Component<IH5PPlayerUIProps> {\n    constructor(props: IH5PPlayerUIProps) {\n        super(props);\n        this.h5pPlayer = createRef();\n    }\n\n    private h5pPlayer: RefObject<H5PPlayerComponent>;\n\n    public componentDidMount(): void {\n        this.registerEvents();\n        this.setServiceCallbacks();\n    }\n\n    public componentDidUpdate(): void {\n        this.registerEvents();\n        this.setServiceCallbacks();\n    }\n\n    public componentWillUnmount(): void {\n        this.unregisterEvents();\n    }\n\n    /**\n     * The internal H5P instance object of the H5P content.\n     *\n     * Only available after the `initialized` event was fired. Important: This\n     * object is only partially typed and there are more properties and methods\n     * on it!\n     */\n    public get h5pInstance(): IH5PInstance | undefined {\n        return this.h5pPlayer.current?.h5pInstance;\n    }\n\n    /**\n     * The global H5P object / namespace (normally accessible through \"H5P...\"\n     * or \"window.H5P\") of the content type. Depending on the embed type this\n     * can be an object from the internal iframe, so you can use it to break the\n     * barrier of the iframe and execute JavaScript inside the iframe.\n     *\n     * Only available after the `initialized` event was fired. Important: This\n     * object is only partially typed and there are more properties and methods\n     * on it!\n     */\n    public get h5pObject(): IH5P | undefined {\n        return this.h5pPlayer.current?.h5pObject;\n    }\n\n    /**\n     * Returns the copyright notice in HTML that you can insert somewhere to\n     * display it. Undefined if there is no copyright information.\n     */\n    public getCopyrightHtml(): string {\n        return this.h5pPlayer.current?.getCopyrightHtml() ?? '';\n    }\n\n    public getSnapshotBeforeUpdate(): void {\n        // Should the old editor instance be destroyed, we unregister from it...\n        this.unregisterEvents();\n        return null;\n    }\n\n    /**\n     * @returns true if there is copyright information to be displayed.\n     */\n    public hasCopyrightInformation(): boolean {\n        return this.h5pPlayer.current?.hasCopyrightInformation();\n    }\n\n    public render(): ReactNode {\n        return (\n            <h5p-player\n                ref={this.h5pPlayer}\n                content-id={this.props.contentId}\n            />\n        );\n    }\n\n    /**\n     * Displays the copyright notice in the regular H5P way.\n     */\n    public showCopyright(): void {\n        this.h5pPlayer.current?.showCopyright();\n    }\n\n    /**\n     * Asks the H5P content to resize itself inside the dimensions of the\n     * container.\n     *\n     * Has no effect until the H5P object has fully initialized.\n     */\n    public resize(): void {\n        this.h5pPlayer.current?.resize();\n    }\n\n    private loadContentCallbackWrapper = (\n        contentId: string\n    ): Promise<IPlayerModel> => this.props.loadContentCallback(contentId);\n\n    private onInitialized = (\n        event: CustomEvent<{ contentId: string }>\n    ): void => {\n        if (this.props.onInitialized) {\n            this.props.onInitialized(event.detail.contentId);\n        }\n    };\n\n    private onxAPIStatement = (\n        event: CustomEvent<{\n            context: IContext;\n            event: IxAPIEvent;\n            statement: any;\n        }>\n    ): void => {\n        if (this.props.onxAPIStatement) {\n            this.props.onxAPIStatement(\n                event.detail.statement,\n                event.detail.context,\n                event.detail.event\n            );\n        }\n    };\n\n    private registerEvents(): void {\n        this.h5pPlayer.current?.addEventListener(\n            'initialized',\n            this.onInitialized\n        );\n        if (this.props.onxAPIStatement) {\n            this.h5pPlayer.current?.addEventListener(\n                'xAPI',\n                this.onxAPIStatement\n            );\n        }\n    }\n\n    private setServiceCallbacks(): void {\n        if (this.h5pPlayer.current) {\n            this.h5pPlayer.current.loadContentCallback =\n                this.loadContentCallbackWrapper;\n        }\n    }\n\n    private unregisterEvents(): void {\n        this.h5pPlayer.current?.removeEventListener(\n            'initialized',\n            this.onInitialized\n        );\n        if (this.props.onxAPIStatement) {\n            this.h5pPlayer.current?.removeEventListener(\n                'xAPI',\n                this.onxAPIStatement\n            );\n        }\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}